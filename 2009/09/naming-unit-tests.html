<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Naming Unit Tests</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="I spent some of this last weekend writing my first real unit tests, and I noticed by the end of the weekend that they were not exactly maintainable (a common problem for first-time unit testers). I understood the theory of unit tests, so I didn’t make the mistakes of having dependent tests or testing multiple failures in a single unit test. However, my unit tests are on the long side (up to ~20 lines), mainly because I’m testing a complex threading and synchronization library (Nito.Async)" />
    <link rel="canonical" href="http://blog.stephencleary.com/2009/09/naming-unit-tests.html" />
    
    <link rel="alternate" type="application/rss+xml" title="Stephen Cleary (the blog)" href="http://feeds.feedburner.com/NitoPrograms" />
    
    <link type="text/css" rel="stylesheet" href="//netdna.bootstrapcdn.com/bootswatch/3.2.0/spacelab/bootstrap.min.css" />
    <link type="text/css" rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" />
    <link type="text/css" rel="stylesheet" href="http://stephencleary.com/css/main.css" />
    <meta name="application-name" content="Stephen Cleary" />
    <link rel="apple-touch-icon" sizes="57x57" href="http://stephencleary.com/icons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://stephencleary.com/icons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://stephencleary.com/icons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="http://stephencleary.com/icons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="http://stephencleary.com/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="http://stephencleary.com/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="http://stephencleary.com/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="http://stephencleary.com/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" href="http://stephencleary.com/icons/apple-touch-icon.png"/>
    <link rel="apple-touch-icon-precomposed" href="http://stephencleary.com/icons/apple-touch-icon-precomposed.png"/>
    <link rel="icon" type="image/png" href="http://stephencleary.com/icons/favicon-196x196.png" sizes="196x196">
    <link rel="icon" type="image/png" href="http://stephencleary.com/icons/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="http://stephencleary.com/icons/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="http://stephencleary.com/icons/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="http://stephencleary.com/icons/favicon-32x32.png" sizes="32x32">
    
</head>
<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <div class="navbar-brand-container"><a class="navbar-brand" href="http://stephencleary.com">Stephen Cleary</a></div>
    </div>

    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
            <li  class="active"  ><a href="http://blog.stephencleary.com">Blog</a></li>
            <li  ><a href="http://stephencleary.com/projects/">Projects</a></li>
            <li  ><a href="http://stephencleary.com/publications/">Publications</a></li>
            <li  ><a href="http://stephencleary.com/contact/">Contact</a></li>
            <li><a href="http://feeds.feedburner.com/NitoPrograms"><i class="fa fa-rss-square fa-lg"></i></a></li>
            <li  ><a href="http://stephencleary.com/search/"><i class="fa fa-search"></i></a></li>
        </ul>
    </div>
</nav>

    <div class="container-fluid">
        <div class="col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
            <div class="post">

  <header>
      <div class="page-header">
          <h1>Naming Unit Tests</h1>
          <small><time datetime="2009-09-01">Sep 1, 2009</time> &bull; <a data-disqus-identifier="/2009/09/naming-unit-tests" href="#disqus_thread">Comments</a></small>
      </div>
  </header>

  <article>
  <p>I spent some of this last weekend writing my first real unit tests, and I noticed by the end of the weekend that they were not exactly maintainable (a common problem for first-time unit testers). I understood the theory of unit tests, so I didn’t make the mistakes of having dependent tests or testing multiple failures in a single unit test. However, my unit tests are on the long side (up to ~20 lines), mainly because I’m testing a complex threading and synchronization library (<a href="http://www.codeplex.com/NitoAsync">Nito.Async</a>)</p>

<p>My biggest problem was naming. There are many different situations that need to be tested when working with these low-level synchronization objects (indeed, I’ve been enlightened that code coverage is a nearly useless metric for the Nito.Async library). As a result, there are more than 100 unit tests already, and I still have one of the more complex components to test. Even though the unit tests are grouped by component, the individual test names are still inadequate.</p>

<p>Take one example unit test method for the ActionDispatcher, named “TestCurrentPropertyInsideAction”. Not a very good name; it does describe the <em>situation</em> (the Current property is accessed from inside an action), but it doesn’t describe the <em>expected behavior</em> (that the Current property should be that action’s ActionDispatcher). For that matter, the situation could read better, too. I wanted to fix this test name, but also develop a consistent naming scheme.</p>

<p>So, I turned to my trusty book (which I have not finished reading), <a href="http://www.amazon.com/gp/product/1933988274?ie=UTF8&amp;tag=stepheclearys-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1933988274">The Art of Unit Testing</a> and skipped to the tips on maintainable unit tests. Long story short: he had some recommendations I didn’t particularly care for regarding naming unit tests. Unit testing is still relatively new, and “best practices” are still in development, so I turned to Google, and there are a couple of independently discovered alternatives.</p>

<p>Here’s my opinion on three different approaches I’ve found. Each one is tested with my problem case “TestCurrentPropertyInsideAction” as an example.</p>

<h2 id="common-elements">Common Elements</h2>

<p>Each of the naming conventions have a “method”, “stimulus”, or “subject” that they are testing. They also have a “state”, “context” or “scenario” defining the situation in which the test takes place. Finally, each convention has a “behavior” or “result” that is expected. These naming conventions were developed independently, from different perspectives, and they still show a remarkable commonality. The obvious conclusion is that these three elements are criticial components in any unit test name.</p>

<h2 id="option-1---methodstatebehavior">Option 1 - Method/State/Behavior</h2>

<p>This is the method recommended by <a href="http://www.amazon.com/gp/product/1933988274?ie=UTF8&amp;tag=stepheclearys-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1933988274">The Art of Unit Testing</a>; if you’re following along at home, this pattern is also described on <a href="http://weblogs.asp.net/rosherove/archive/2005/04/03/TestNamingStandards.aspx">the author’s blog</a>.</p>

<p>The “Method” is the name of the method/property that is being tested. The “State” is the state of the object and parameters passed to that method. The “Behavior” is the expected behavior of that method or expected value of that property.</p>

<p>Original example: “Sum_NegativeNumberAs1stParam_ExceptionThrown()”</p>

<p>Applied example: “Current_FromInsideAction_ActionDispatcherForThatAction()”</p>

<p>The main reason I dislike this approach is because it has an emphasis on method and property testing. In general, I think this would lead to more “procedural tests” rather than “object-oriented tests”; I’m not talking about the unit test methods themselves (which are of course procedural), but rather about <em>how one conceives of the component under test</em>. This would have the side effect of writing unit tests to achieve code coverage, rather than testing state as well as behaviour.</p>

<p>Another reason I’m not too fond is that it does suffer from some readability problems. More readable examples would be “Sum_WhenFirstParamIsNegative_ThrowsException()” or “Current_WhenReadFromInsideAction_IsTheActionDispatcherForThatAction()”.</p>

<h2 id="option-2---stimulusresultcontext">Option 2 - Stimulus/Result/Context</h2>

<p>The Stimulus/Result/Context approach is described <a href="http://weblogs.asp.net/pgielens/archive/2006/04/30/444517.aspx">on this blog post</a>.  The “Stimulus” is what the object is requested to do. The “Result” is the expected behavior. The “Context” is the relevant state of the object.</p>

<p>The original example was a bit unreadable for my taste: “CalculatePayIncludingSalesBonusAfterSalesBonusGrantedToEmployee()”.</p>

<p>Splitting the components with underscores makes it better: “CalculatePay_IncludingSalesBonus_AfterSalesBonusGrantedToEmployee()”.</p>

<p>Applied example: “CurrentProperty_IsSameActionDispatcherAsScopingAction_WithinActionScope()”.</p>

<p>Still not too readable. Better examples would be “CalculatedPay_IncludesSalesBonus_AfterSalesBonusGrantedToEmployee()” and “CurrentProperty_IsSameActionDispatcherAsScopingAction_WhenWithinActionScope()”.</p>

<p>The main reason I don’t like this approach is that it places the result in the middle and the context last. I think it’s more natural to think of context in the middle and the result last. For example, I think it’s more natural to state “<em>if</em> the car is exceeding the speed limit, <em>then</em> it becomes eligible to receive a ticket” rather than “a car becomes eligible to receive a ticket <em>if</em> it exceeds the speed limit”. This is personal opinion (like the rest of this post!); I just prefer “if/then” rather than “then/if”.</p>

<p>Another reason is that it does seem to emphasize testing behavior rather than state. It is, however, more object-oriented than option 1.</p>

<h2 id="option-3---subjectscenarioresult">Option 3 - Subject/Scenario/Result</h2>

<p>Described <a href="http://blog.codeville.net/2009/08/24/writing-great-unit-tests-best-and-worst-practises/">here</a>, this approach seems to combine a data-oriented mindset with placing the result last.</p>

<p>The “Subject” is the item under test. The “Scenario” is the context of the test. The “Result” is the expected result of the test.</p>

<p>Original example: “ProductPurchaseAction_IfStockIsZero_RendersOutOfStockView()”.</p>

<p>Applied example: “Current_FromInsideAction_IsActionDispatcherForThatAction()”.</p>

<p>This naming convention is more data-centered (note the “ProductPurchase_Action_” subject), so it should work well with MVVM-based designs. If “subject” could be interpreted as “object method” as well, then this approach could be called more object-oriented.</p>

<p>In short, this option is a more readable and more object-oriented version of the first option. I’ve decided to go forward with this one for my project; your mileage may vary.</p>


  </article>
    
    <footer>
        
        
        
        <ul class="pager">
            <li class="previous"><a href="/2009/08/q-is-call-to-gckeepalivethis-required.html" title="Q&amp;A: Is a call to GC.KeepAlive(this) required in Dispose?">&larr; Previous Post</a></li>
            <li class="next"><a href="/2009/09/notes-from-rx-talk.html" title="Notes from the Rx talk">Next Post &rarr;</a></li>
        </ul>

        <div id="disqus_thread"></div>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </footer>
</div>
        </div>
        <div class="col-sm-2 col-md-3 col-md-offset-0 col-lg-2 col-lg-offset-1 affix" data-spy="affix" role="navigation">
            
            
        </div>
        <div class="col-sm-2 sidebar">
            <div class="panel panel-default">
                <div class="panel-heading">About Stephen Cleary</div>
                <div class="panel-body">
                    <div class="center"><img src="http://stephencleary.com/www.assets/Me-large.jpg"/></div>
                    <div class="center vertical-margins">Stephen Cleary is a <a href="http://www.landmarkbaptist.ws/salvation">Christian</a>, <a href="http://picasaweb.google.com/stephenandmandy">husband, father,</a> and programmer living in Northern Michigan.</div>
                    <div class="center"><a href="http://mvp.microsoft.com/en-us/mvp/Stephen%20Cleary-5000058"><img class="mvp-logo" src="http://stephencleary.com/www.assets/MVP.png"/></a></div>
                </div>
            </div>
            <div class="panel panel-primary">
                <div class="panel-heading">My book</div>
                <div class="panel-body center">
                    <div><a href="http://tinyurl.com/ConcurrencyCookbook"><img src="http://stephencleary.com/www.assets/Book-small.jpg"/></a></div>
                    <div>Available from <a href="http://tinyurl.com/ConcurrencyCookbook">O'Reilly</a> or <a href="http://tinyurl.com/ConcurrencyCookbookAmazon">Amazon</a>.</div>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">Advertisement</div>
                <div class="panel-body">
                    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-2749292939902134" data-ad-slot="7584809820" data-ad-format="auto"></ins>
                </div>
            </div>
            
            <div class="panel panel-primary">
                <div class="panel-heading">Popular Posts</div>
                <div class="panel-body">
                    <ul class="nav nav-pills nav-stacked">
                        <li><a href="/2012/02/async-and-await.html">Async/await Intro</a></li>
                        <li><a href="/2013/11/there-is-no-thread.html">There Is No Thread</a></li>
                        <li><a href="/2012/07/dont-block-on-async-code.html">Don't Block on Async Code</a></li>
                    </ul>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">Series</div>
                <div class="panel-body">
                    <ul class="nav nav-pills nav-stacked">
                        <li><a href="/2014/04/a-tour-of-task-part-0-overview.html">A Tour of Task</a></li>
                        <li><a href="/2013/10/taskrun-etiquette-and-proper-usage.html">Task.Run Etiquette</a></li>
                        <li><a href="/2013/05/taskrun-vs-backgroundworker-intro.html">Task.Run vs. BackgroundWorker</a></li>
                        <li><a href="/2013/01/async-oop-0-introduction.html">Async OOP</a></li>
                        <li><a href="/2009/04/tcpip-net-sockets-faq.html">TCP/IP .NET Sockets FAQ</a></li>
                        <li><a href="/2013/10/managed-services-roundup.html">Managed Services</a></li>
                        <li><a href="/2009/08/how-to-implement-idisposable-and.html">IDisposable and Finalizers</a></li>
                        <li><a href="/2011/02/option-parsing-introduction.html">Option Parsing</a></li>
                    </ul>
                </div>
            </div>
            
        </div>
    </div>

    <div class="google">
        <gcse:searchresults></gcse:searchresults>
    </div>
    
    <!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
<script type="text/javascript">window.jQuery || document.write('<script src="/lib/jquery-2.1.1.min.js"><\/script>')</script>

<!-- Bootstrap -->
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script type="text/javascript">window.jQuery.fn.modal || document.write('<script src="/lib/bootstrap.min.js"><\/script>')</script>
<script type="text/javascript">
    (function($) {
        $(function() {
            if ($('body').css('color') !== 'rgb(102, 102, 102)') {
                $('head').prepend('<link rel="stylesheet" href="/lib/bootstrap.min.css" />');
            }
        });
    })(window.jQuery);
</script>

<!-- Font Awesome -->
<span id="facheck" class="fa" style="display:none"></span>
<script type="text/javascript">
    (function($) {
        $(function() {
            if ($('#facheck').css('fontFamily') !== 'FontAwesome') {
                $('head').prepend('<link rel="stylesheet" href="/lib/font-awesome.min.css" />');
            }
        });
    })(window.jQuery);
</script>

<!-- Scroll the sidebar into view (if necessary) -->


<!-- Google analytics -->
<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-8910661-5', 'stephencleary.com');
    ga('send', 'pageview');
</script>







<!-- Disqus variables -->
<script type="text/javascript">
    var disqus_shortname = 'stephencleary';
    var disqus_identifier = "/2009/09/naming-unit-tests";
    var disqus_title = "Naming Unit Tests";
    var disqus_url = "http://blog.stephencleary.com/2009/09/naming-unit-tests.html";
</script>

<!-- Disqus comment counter -->
<script type="text/javascript">
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
    }());
</script>

<!-- Disqus comment section -->
<script type="text/javascript">
    (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>



<!-- Google AdSense -->
<script src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Moment -->
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.6.0/moment.min.js"></script>
<script type="text/javascript">window.moment || document.write('<script src="/lib/moment.min.js"><\/script>')</script>
<script type="text/javascript">
    (function($) {
        $(function() {
            $('time').each(function (_, e) {
                var text = moment($(e).attr('datetime'), 'YYYY-MM-DD').fromNow();
                $(e).text(function(_, oldText) { return text + ' (' + oldText + ')'; });
            });
        });
    })(window.jQuery);
</script>

</body>
</html>