<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Getting the ObjectContext from an EntityObject</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="There are a few situations where it’s useful to get an ObjectContext from an EntityObject. Note that in general I do not recommend a design that depends on this; there doesn’t appear to be an easy way to do this using code first in EF 4.1 (using the DbContext API). That said, either of the solutions in this blog post will work when using the ObjectContext API." />
    <link rel="canonical" href="http://blog.stephencleary.com/2011/05/getting-objectcontext-from-entityobject.html" />
    
    <link rel="alternate" type="application/rss+xml" title="Stephen Cleary (the blog)" href="http://feeds.feedburner.com/NitoPrograms" />
    
    <link href="//netdna.bootstrapcdn.com/bootswatch/3.2.0/spacelab/bootstrap.min.css" rel="stylesheet" />
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="http://stephencleary.com/css/main.css" />
    <meta name="application-name" content="Stephen Cleary" />
    <link rel="apple-touch-icon" sizes="57x57" href="http://stephencleary.com/icons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://stephencleary.com/icons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://stephencleary.com/icons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="http://stephencleary.com/icons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="http://stephencleary.com/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="http://stephencleary.com/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="http://stephencleary.com/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="http://stephencleary.com/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" href="http://stephencleary.com/icons/apple-touch-icon.png"/>
    <link rel="apple-touch-icon-precomposed" href="http://stephencleary.com/icons/apple-touch-icon-precomposed.png"/>
    <link rel="icon" type="image/png" href="http://stephencleary.com/icons/favicon-196x196.png" sizes="196x196">
    <link rel="icon" type="image/png" href="http://stephencleary.com/icons/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="http://stephencleary.com/icons/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="http://stephencleary.com/icons/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="http://stephencleary.com/icons/favicon-32x32.png" sizes="32x32">
</head>
<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <div class="navbar-brand-container"><a class="navbar-brand" href="http://stephencleary.com">Stephen Cleary</a></div>
    </div>

    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
            <li  class="active"  ><a href="http://blog.stephencleary.com">Blog</a></li>
            <li  ><a href="http://stephencleary.com/projects/">Projects</a></li>
            <li  ><a href="http://stephencleary.com/publications/">Publications</a></li>
            <li  ><a href="http://stephencleary.com/contact/">Contact</a></li>
            <li><a href="http://feeds.feedburner.com/NitoPrograms"><i class="fa fa-rss-square fa-lg"></i></a></li>
            <li  ><a href="http://stephencleary.com/search/"><i class="fa fa-search"></i></a></li>
        </ul>
    </div>
</nav>

    <div class="container-fluid">
        <div class="col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
            <div class="post">

  <header>
      <div class="page-header">
          <h1>Getting the ObjectContext from an EntityObject</h1>
          <small><time datetime="2011-05-26">May 26, 2011</time> &bull; <a data-disqus-identifier="/2011/05/getting-objectcontext-from-entityobject" href="#disqus_thread">Comments</a></small>
      </div>
  </header>

  <article>
  <p>There are a few situations where it’s useful to get an <strong>ObjectContext</strong> from an <strong>EntityObject</strong>. Note that in general I do not recommend a design that depends on this; there doesn’t appear to be an easy way to do this using code first in EF 4.1 (using the <strong>DbContext</strong> API). That said, either of the solutions in this blog post will work when using the <strong>ObjectContext</strong> API.</p>

<p>The most common solution for this problem is from <a href="http://blogs.msdn.com/b/alexj/archive/2009/06/08/tip-24-how-to-get-the-objectcontext-from-an-entity.aspx">a 2009 Microsoft blog post by Alex James</a> (<a href="http://www.webcitation.org/5yYYB64NN">webcite</a>). Unfortunately, that solution has several limitations (including the requirement that the entities must have relations to other entities). Both of the solutions below do not have these limitations.</p>

<p>We use an example entity container named <strong>NorthwindEntites</strong>, derived from <strong>ObjectContext</strong>. To this we will add a factory method <strong>FromEntity(EntityObject entity)</strong>, which retrieves the <strong>NorthwindEntities</strong> instance to which that entity is attached, or <strong>null</strong> if the entity is detached.</p>

<h2 id="solution-1-dynamic">Solution 1: Dynamic</h2>

<p>The idea behind this solution is to add a property to the entity type that points to its own <strong>ObjectContext</strong>. It’s possible to do this by <a href="http://msdn.microsoft.com/en-us/library/dd456821.aspx">modifying the code-generating</a> <a href="http://msdn.microsoft.com/en-us/library/ff477605.aspx">template</a> file, but it’s also possible to just add the property to each entity type manually and use dynamic duck typing to access it.</p>

<p>The modified <strong>NorthwindEntities</strong> uses <strong>OnContextCreated</strong> to hook into its constructor and set up event handlers to respond whenever an entity is added to or removed from this context. Each event handler uses dynamic duck typing to access an “ObjectContext” property on the entity; if no such property exists, the entity is ignored.</p>

<div class="highlight"><pre><code class="csharp"><span class="k">using</span> <span class="nn">System.ComponentModel</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Data.Objects.DataClasses</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.CSharp.RuntimeBinder</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">WindowsFormsApplication1</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">NorthwindEntities</span>
  <span class="p">{</span>
    <span class="k">partial</span> <span class="k">void</span> <span class="nf">OnContextCreated</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="n">ObjectMaterialized</span> <span class="p">+=</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
      <span class="p">{</span>
        <span class="k">try</span>
        <span class="p">{</span>
          <span class="kt">dynamic</span> <span class="n">entity</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="n">Entity</span><span class="p">;</span>
          <span class="n">entity</span><span class="p">.</span><span class="n">ObjectContext</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">(</span><span class="n">RuntimeBinderException</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>
      <span class="p">};</span>
      <span class="k">this</span><span class="p">.</span><span class="n">ObjectStateManager</span><span class="p">.</span><span class="n">ObjectStateManagerChanged</span> <span class="p">+=</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Action</span> <span class="p">==</span> <span class="n">CollectionChangeAction</span><span class="p">.</span><span class="n">Add</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
            <span class="kt">dynamic</span> <span class="n">entity</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="n">Element</span><span class="p">;</span>
            <span class="n">entity</span><span class="p">.</span><span class="n">ObjectContext</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">catch</span> <span class="p">(</span><span class="n">RuntimeBinderException</span><span class="p">)</span>
          <span class="p">{</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Action</span> <span class="p">==</span> <span class="n">CollectionChangeAction</span><span class="p">.</span><span class="n">Remove</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="k">try</span>
          <span class="p">{</span>
            <span class="kt">dynamic</span> <span class="n">entity</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="n">Element</span><span class="p">;</span>
            <span class="n">entity</span><span class="p">.</span><span class="n">ObjectContext</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">catch</span> <span class="p">(</span><span class="n">RuntimeBinderException</span><span class="p">)</span>
          <span class="p">{</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">};</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Gets the object context for the entity. Returns &lt;c&gt;null&lt;/c&gt; if the entity is detached or does not define an &lt;c&gt;ObjectContext&lt;/c&gt; property.</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name=&quot;entity&quot;&gt;The entity for which to return the object context.&lt;/param&gt;</span>
    <span class="k">public</span> <span class="k">static</span> <span class="n">NorthwindEntities</span> <span class="nf">FromEntity</span><span class="p">(</span><span class="n">EntityObject</span> <span class="n">entity</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">try</span>
      <span class="p">{</span>
        <span class="kt">dynamic</span> <span class="n">dynamicEntity</span> <span class="p">=</span> <span class="n">entity</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">dynamicEntity</span><span class="p">.</span><span class="n">ObjectContext</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">catch</span> <span class="p">(</span><span class="n">RuntimeBinderException</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>The disadvantage to this approach is that you have to add an <strong>ObjectContext</strong> property to each entity type, like this:</p>

<div class="highlight"><pre><code class="csharp"><span class="k">namespace</span> <span class="nn">WindowsFormsApplication1</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">Order</span>
  <span class="p">{</span>
    <span class="c1">/// &lt;summary&gt; </span>
    <span class="c1">/// Gets or sets the context for this entity.</span>
    <span class="c1">///  This should not be set by end-user code; this property will be set</span>
    <span class="c1">///  automatically as entities are created or added,</span>
    <span class="c1">///  and will be set to &lt;c&gt;null&lt;/c&gt; as entities are detached.</span>
    <span class="c1">/// &lt;/summary&gt; </span>
    <span class="k">internal</span> <span class="n">NorthwindEntities</span> <span class="n">ObjectContext</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>Alternatively, you could modify the creation template. Either way, it’s a fair amount of work.</p>

<h2 id="solution-2-connected-properties">Solution 2: Connected Properties</h2>

<p>The <a href="http://www.nuget.org/List/Packages/ConnectedProperties">Connected Properties</a> library may be used to “attach” properties to entity objects at run-time. This means it’s no longer necessary to add the <strong>ObjectContext</strong> property on each entity type.</p>

<p>This modified <strong>NorthwindEntities</strong> uses the same hooks as the one above, but it uses connected properties instead of dynamic duck typing:</p>

<div class="highlight"><pre><code class="csharp"><span class="k">using</span> <span class="nn">System.ComponentModel</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Data.Objects.DataClasses</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Nito.ConnectedProperties</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Nito.ConnectedProperties.Implicit</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">WindowsFormsApplication1</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">NorthwindEntities</span>
  <span class="p">{</span>
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// The object context connected property type.</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">private</span> <span class="k">struct</span> <span class="nc">ObjectContextProperty</span> <span class="p">{</span> <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Gets the object context connected property for a specified carrier object.</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name=&quot;entity&quot;&gt;The carrier object.&lt;/param&gt;</span>
    <span class="c1">/// &lt;returns&gt;The connected property.&lt;/returns&gt;</span>
    <span class="k">private</span> <span class="k">static</span> <span class="n">IConnectibleProperty</span><span class="p">&lt;</span><span class="n">NorthwindEntities</span><span class="p">&gt;</span> <span class="n">ObjectContext</span><span class="p">(</span><span class="kt">object</span> <span class="n">entity</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="n">entity</span><span class="p">.</span><span class="n">GetConnectedProperty</span><span class="p">&lt;</span><span class="n">NorthwindEntities</span><span class="p">,</span> <span class="n">ObjectContextProperty</span><span class="p">&gt;();</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Handles post-construction event.</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">partial</span> <span class="k">void</span> <span class="nf">OnContextCreated</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="n">ObjectMaterialized</span> <span class="p">+=</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
      <span class="p">{</span>
        <span class="n">ObjectContext</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Entity</span><span class="p">).</span><span class="n">Set</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
      <span class="p">};</span>

      <span class="k">this</span><span class="p">.</span><span class="n">ObjectStateManager</span><span class="p">.</span><span class="n">ObjectStateManagerChanged</span> <span class="p">+=</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Action</span> <span class="p">==</span> <span class="n">CollectionChangeAction</span><span class="p">.</span><span class="n">Add</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="n">ObjectContext</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Element</span><span class="p">).</span><span class="n">Set</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Action</span> <span class="p">==</span> <span class="n">CollectionChangeAction</span><span class="p">.</span><span class="n">Remove</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="n">ObjectContext</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Element</span><span class="p">).</span><span class="n">Set</span><span class="p">(</span><span class="k">null</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">};</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Gets the object context for the entity. Returns &lt;c&gt;null&lt;/c&gt; if the entity is detached.</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="c1">/// &lt;param name=&quot;entity&quot;&gt;The entity for which to return the object context.&lt;/param&gt;</span>
    <span class="k">public</span> <span class="k">static</span> <span class="n">NorthwindEntities</span> <span class="nf">FromEntity</span><span class="p">(</span><span class="n">EntityObject</span> <span class="n">entity</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="nf">ObjectContext</span><span class="p">(</span><span class="n">entity</span><span class="p">).</span><span class="n">GetOrConnect</span><span class="p">(</span><span class="k">null</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>The disadvantage of this approach is that you do need to take a dependency on the <a href="http://www.nuget.org/List/Packages/ConnectedProperties">Connected Properties</a> library, but I think that’s a reasonable tradeoff.</p>

<p>This post was inspired by <a href="http://stackoverflow.com/questions/5707312/whats-the-fastest-way-to-get-an-objectcontext-reference-from-an-entity-object">a recent SO question</a>.</p>


  </article>
    
    <footer>
        
        
        
        <ul class="pager">
            <li class="previous"><a href="/2011/05/signed-and-unsigned-comparisons-in-c-c.html" title="Signed and Unsigned Comparisons in C, C#, and T-SQL">&larr; Previous Post</a></li>
            <li class="next"><a href="/2011/06/how-to-run-processes-remotely.html" title="How to Run Processes Remotely">Next Post &rarr;</a></li>
        </ul>

        <div id="disqus_thread"></div>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </footer>
</div>
        </div>
        <div class="col-sm-2 col-md-3 col-md-offset-0 col-lg-2 col-lg-offset-1 affix" data-spy="affix" role="navigation">
            
            
        </div>
        <div class="col-sm-2 col-md-offset-1 sidebar">
            <div class="panel panel-default">
                <div class="panel-heading">About Stephen Cleary</div>
                <div class="panel-body">
                    <div class="center"><img src="http://stephencleary.com/www.assets/Me-large.jpg"/></div>
                    <div class="center">Stephen Cleary is a <a href="http://www.landmarkbaptist.ws/salvation">Christian</a>, <a href="http://picasaweb.google.com/stephenandmandy">husband, father,</a> and programmer living in Northern Michigan.</div>
                    <div class="center"><a href="http://mvp.microsoft.com/en-us/mvp/Stephen%20Cleary-5000058"><img class="mvp-logo" src="http://stephencleary.com/www.assets/MVP.png"/></a></div>
                </div>
            </div>
            <div class="panel panel-primary">
                <div class="panel-heading">My book</div>
                <div class="panel-body center">
                    <div><a href="http://tinyurl.com/ConcurrencyCookbook"><img src="http://stephencleary.com/www.assets/Book-small.jpg"/></a></div>
                    <div>Available from <a href="http://tinyurl.com/ConcurrencyCookbook">O'Reilly</a> or <a href="http://tinyurl.com/ConcurrencyCookbookAmazon">Amazon</a>.</div>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">Advertisement</div>
                <div class="panel-body">
                    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-2749292939902134" data-ad-slot="7584809820" data-ad-format="auto"></ins>
                </div>
            </div>
            
            <div class="panel panel-primary">
                <div class="panel-heading">Popular Posts</div>
                <div class="panel-body">
                    <ul class="nav nav-pills nav-stacked">
                        <li><a href="/2012/02/async-and-await.html">Async/await Intro</a></li>
                        <li><a href="/2013/11/there-is-no-thread.html">There Is No Thread</a></li>
                        <li><a href="/2012/07/dont-block-on-async-code.html">Don't Block on Async Code</a></li>
                    </ul>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">Series</div>
                <div class="panel-body">
                    <ul class="nav nav-pills nav-stacked">
                        <li><a href="/2014/04/a-tour-of-task-part-0-overview.html">A Tour of Task</a></li>
                        <li><a href="/2013/10/taskrun-etiquette-and-proper-usage.html">Task.Run Etiquette</a></li>
                        <li><a href="/2013/05/taskrun-vs-backgroundworker-intro.html">Task.Run vs. BackgroundWorker</a></li>
                        <li><a href="/2013/01/async-oop-0-introduction.html">Async OOP</a></li>
                        <li><a href="/2009/04/tcpip-net-sockets-faq.html">TCP/IP .NET Sockets FAQ</a></li>
                        <li><a href="/2013/10/managed-services-roundup.html">Managed Services</a></li>
                        <li><a href="/2009/08/how-to-implement-idisposable-and.html">IDisposable and Finalizers</a></li>
                        <li><a href="/2011/02/option-parsing-introduction.html">Option Parsing</a></li>
                    </ul>
                </div>
            </div>
            
        </div>
    </div>

    <div class="google">
        <gcse:searchresults></gcse:searchresults>
    </div>
    
    <!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
<script type="text/javascript">window.jQuery || document.write('<script src="/lib/jquery-2.1.1.min.js"><\/script>')</script>

<!-- Bootstrap -->
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script type="text/javascript">window.jQuery.fn.modal || document.write('<script src="/lib/bootstrap.min.js"><\/script>')</script>
<script type="text/javascript">
    (function($) {
        $(function() {
            if ($('body').css('color') !== 'rgb(102, 102, 102)') {
                $('head').prepend('<link rel="stylesheet" href="/lib/bootstrap.min.css" />');
            }
        });
    })(window.jQuery);
</script>

<!-- Font Awesome -->
<span id="facheck" class="fa" style="display:none"></span>
<script type="text/javascript">
    (function($) {
        $(function() {
            if ($('#facheck').css('fontFamily') !== 'FontAwesome') {
                $('head').prepend('<link rel="stylesheet" href="/lib/font-awesome.min.css" />');
            }
        });
    })(window.jQuery);
</script>

<!-- Scroll the sidebar into view (if necessary) -->


<!-- Google analytics -->
<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-8910661-5', 'stephencleary.com');
    ga('send', 'pageview');
</script>







<!-- Disqus variables -->
<script type="text/javascript">
    var disqus_shortname = 'stephencleary';
    var disqus_identifier = "/2011/05/getting-objectcontext-from-entityobject";
    var disqus_title = "Getting the ObjectContext from an EntityObject";
    var disqus_url = "http://blog.stephencleary.com/2011/05/getting-objectcontext-from-entityobject.html";
</script>

<!-- Disqus comment counter -->
<script type="text/javascript">
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
    }());
</script>

<!-- Disqus comment section -->
<script type="text/javascript">
    (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>



<!-- Google AdSense -->
<script src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Moment -->
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.6.0/moment.min.js"></script>
<script type="text/javascript">window.moment || document.write('<script src="/lib/moment.min.js"><\/script>')</script>
<script type="text/javascript">
    (function($) {
        $(function() {
            $('time').each(function (_, e) {
                var text = moment($(e).attr('datetime'), 'YYYY-MM-DD').fromNow();
                $(e).text(function(_, oldText) { return text + ' (' + oldText + ')'; });
            });
        });
    })(window.jQuery);
</script>

</body>
</html>